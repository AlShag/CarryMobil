{% extends "main/index.html" %}
{% load static %}
{% block title %}Журнал заявок{% endblock %}
{% block css %}
    {{ block.super }}
    <link rel="stylesheet" href="{% static 'styles/order_manage.css' %}">
{% endblock %}
{% block script %}
{{ block.super }}
    <script src="{% static 'scripts/order.js' %}"></script>
{% endblock %}
{% block content %}
    {% if user.is_staff %}
        <div class="orders_area">
            <div class="orders_form">
                <div class="container">
                    <div class="orders_filter">
                        <div class="orders_filter_form">
                            <div class="flex">
                                <section>
                                    <h2>Дата отправки:</h2>
                                    <div class="filter_value">
                                        <label for="">От:</label><input type="datetime-local" name="date" class="data_filter" id="filter_date1"><br>
                                        <label for="">До:</label><input type="datetime-local" name="date" class="data_filter" id="filter_date2">
                                    </div>
                                </section>
                                <section>
                                    <h2>Вид груза:</h2>
                                    <div class="filter_value">
                                        <input type="checkbox" name="" id="">
                                    </div>
                                </section>
                                <section>
                                    <h2>Статус заявки:</h2>
                                    <div class="filter_value">
                                        <ul>
                                            <li>
                                                <input type="checkbox" name="status" id="complited_orders" value="Выполнена">
                                                <label for="complited_orders">Выполнена</label>
                                            </li>
                                            <li>
                                                <input type="checkbox" name="status" id="expected_orders" value="Ожидается">
                                                <label for="expected_orders">Ожидается</label>
                                            </li>
                                            <li>
                                                <input type="checkbox" name="status" id="canceled_orders" value="Отменена">
                                                <label for="canceled_orders">Отменена</label>
                                            </li>
                                        </ul>
                                    </div>
                                </section>
                                <section id="filter_applay">
                                    <input type="submit" value="Применить">
                                </section>
                            </div>
                        </div>
                    </div>
                    <div>
                        <table id="orders_table">
                            <tr id="orders_table_title">
                                <th class="">
                                    Номер заявки
                                </th>
                                <th class="">
                                    Дата исполнения
                                </th>
                                <th class="">
                                    Маршрут
                                </th>
                                <th class="">
                                    Грузчики<br>( чел/час )
                                </th>
                                <th class="">
                                    Вид груза
                                </th>
                                <th class="">
                                    Сумма
                                </th>
                                <th class="">
                                    Статус
                                </th>
                                <th class="">
                                    Действие
                                </th>
                            </tr>
                        {% for order in orders %}
                                <tr data-href="{% url 'order_detail' pk=order.pk %}" class="orders_tr">
                                    <td class="">
                                        <a href="{% url 'order_detail' pk=order.pk %}">{{ order.id }}</a>
                                    </td>
                                    <td class="">
                                        {% if not order.start_time == None %}
                                        <a href="{% url 'order_detail' pk=order.pk %}">{{ order.start_time | date:'c' }}</a>
                                        {% endif %}
                                    </td>
                                    <td class="full_roads">
                                        <a href="{% url 'order_detail' pk=order.pk %}">{{ order.full_road | truncatewords:7 }}</a>
                                    </td>
                                    <td class="">
                                        {% if not order.loader_count == None %}
                                            <a href="{% url 'order_detail' pk=order.pk %}">{{ order.loader_count }}, {{ order.loader_time_count }}</a>
                                        {% endif %}
                                    </td>
                                    <td class="">
                                        <a href="{% url 'order_detail' pk=order.pk %}">{{ order.cargo_type }}</a>
                                    </td>
                                    <td class="">
                                        <a href="{% url 'order_detail' pk=order.pk %}">{{ order.order_price }}</a>
                                    </td>
                                    <td class="order_status">
                                        {% if not order.status == None %}
                                            {% if order.status == 0 %}
                                                <a href="{% url 'order_detail' pk=order.pk %}">Ожидается</a>
                                            {% endif %}
                                            {% if order.status == 1 %}
                                                <a href="{% url 'order_detail' pk=order.pk %}">Выполнено</a>
                                            {% endif %}
                                            {% if order.status == -1 %}
                                                <a href="{% url 'order_detail' pk=order.pk %}">Отменено</a>
                                            {% endif %}
                                        {% endif %}
                                    </td>
                                    <td class="">
                                        <a href="{% url 'order_delete' pk=order.pk %}"><button type="button">Удалить</button></a>
                                    </td>
                                    <td class="order_change">
                                        <a href="{% url 'order_edit' pk=order.pk %}"><button type="button">Редактировать</button></a>
                                    </td>
                                </tr>
                        {% endfor %}
                        </table>
                    </div>
                </div>
                {% else %}
                <span class="text-red font-bold italic text-xl">У вас нет доступа к этой странице</span>
            </div>
        </div>
    {% endif %}
{% endblock %}